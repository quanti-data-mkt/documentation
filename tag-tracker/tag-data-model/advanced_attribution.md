---
description: >-
  The advanced attribution table is a “conversion” scope table. It records all
  conversions made and attributes them to the sessions that participated.
layout:
  title:
    visible: true
  description:
    visible: true
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
---

# advanced\_attribution

***

## <mark style="background-color:purple;">Syncing</mark>

The advanced attribution table is a view. Its data comes directly from the others tables and depends directly on their synchronization frequency. Thus, new conversions will appear on this table once the session has expired, i.e. after a period of inactivity of 30 minutes after the last hit.

***

## <mark style="background-color:purple;">Tables Diagram (ERD)</mark>

{% embed url="https://docs.google.com/presentation/d/13HhIjItxg_pbIgJoKtM03njw2YpWU-J1guYn4bJeTT4" %}
Tag Tracker Tables Diagram
{% endembed %}

***

## Description

### Technical Definition of a conversion

From a technical perspective for Quanti, a conversion is a hit where the value of the `conversion_id` parameter is not `null`, `undefined`, or _empty_. One of these conditions must be satisfied to add a new row in the advanced attribution table.

### Primary keys explanations

The advanced attribution table's primary keys are `hit_id` and `s_session_id` :&#x20;

* We have made the decision to insert a field named `hit_id` into the table, which precisely identifies the hit that registered the conversion from `raw_hits`. This ensures the table's integrity by addressing a potential issue with the uniqueness of `conversion_id`. `hit_id` is technically more precise than the `conversion_id`.
* The `s_session_id` is the second primary key of the table and allows linking a session to a conversion. Multiple sessions can participate in the same conversion, and the same session can participate in multiple conversions.

In this table, a single `conversion_id` can be used across multiple rows because it may have been generated by a series of sessions (One row in the table = one session for a given conversion). Similarly, a `session_id` can also be used on multiple rows because it might have originated several conversions. However, what is essentially maintained is the presence of a unique `session_id` per conversion.

### Attibution rules

We have 2 ways to catch up on sessions and assess their contribution to achieving a conversion :

* By **visitor\_id** : We log all previous sessions that have the same `visitor_id` as the session during which the conversion occurred.
* By **user\_id** : We log all previous sessions that have the same `user_id` as the session during which the conversion occurred.

The values `null`, `undefined`, or _empty_ for `visitor_id` and `user_id` are obviously excluded from the attribution calculation rules.

### path\_index

Maintenant que vous avez compris que la table était composée d'une liste de sessions ayant participé à la réalisation de conversion(s), il est essentiel de comprendre la manière avec laquelle vous pouvez les distinguer d'un point de vue chronologique et notamment comment vous allez devoir faire pour analyser les chemins empruntés par vos internautes et calculer la contribution de chaque session.\
Il y a évidemment le champs "s\_datetime" qui donne la date et l'heure précise du commencement de la session mais nous vous avons facilité l'exercice en mettant en place deux champs :&#x20;

* max\_index : qui donne le nombre total de sessions contributives sur la conversion. La valeur de ce champ est la même pour chaque session (ligne) d'une conversion.
* path\_index : qui donne la position chronologique de la session parmi l'intégralité des sessions contributives sur la conversion.

Pour une conversion enregistrant une multitude de sessions contributives, vous aurez donc dans path\_index des chiffres allant de 1 jusqu'au chiffre représentant le nombre globale de sessions. Et puis vous aurez dans max\_index pour chacune de session, le chiffre max qui représente le nombre globale de sessions.

<figure><img src="../../.gitbook/assets/BigQuery-–-Quanti-–-Console-Google-Cloud.png" alt=""><figcaption></figcaption></figure>

## <mark style="background-color:purple;">Fields definition</mark>
